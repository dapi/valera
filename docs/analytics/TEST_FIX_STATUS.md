# üìä –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 27.10.2025
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** High
**–°—Ç–∞—Ç—É—Å:** –í –ø—Ä–æ—Ü–µ—Å—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚úÖ
```ruby
# Gemfile
group :test do
  gem 'mocha'
  gem 'timecop'
  gem 'minitest-stub_any_instance'
end
```
- `bundle install` –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TelegramUser –º–æ–¥–µ–ª–∏ ‚úÖ
```ruby
def chat_id
  id
end
```
- –ú–µ—Ç–æ–¥ `chat_id` –¥–æ–±–∞–≤–ª–µ–Ω –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è ‚úÖ
- `test/test_helper.rb` –æ–±–Ω–æ–≤–ª–µ–Ω —Å mocha –∏ timecop
- –î–æ–±–∞–≤–ª–µ–Ω `perform_enqueued_jobs` helper –º–µ—Ç–æ–¥
- –í–∫–ª—é—á–µ–Ω–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–π ‚úÖ
- –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä—É—Å—Å–∫–æ–π –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–µ–π
- –ó–∞–º–µ–Ω–µ–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞–ª–∏—á–∏—è –æ—à–∏–±–æ–∫

### 5. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ JSONB —Å–≤–æ–π—Å—Ç–≤ ‚úÖ
- –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è JSONB –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `stringify_keys` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

## üö® –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: Autoload –º–æ–¥–µ–ª–µ–π –≤ —Ç–µ—Å—Ç–∞—Ö
**–û—à–∏–±–∫–∞:** `NameError: uninitialized constant AnalyticsEventTest::AnalyticsEvent`

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º—ã —Å Rails autoload –≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö

**–¢–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ:**
- –û—Ç–∫–ª—é—á–µ–Ω –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º: `parallelize(workers: 1)`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ —è–≤–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –≤ setup

## üìã –û—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–¥–∞—á–∏

### High Priority
1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å autoload –ø—Ä–æ–±–ª–µ–º—É** (15 –º–∏–Ω—É—Ç)
   - –ù–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–µ–π –≤ —Ç–µ—Å—Ç–∞—Ö
   - –í–æ–∑–º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å Rails –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è —Ç–µ—Å—Ç–æ–≤

2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** (20 –º–∏–Ω—É—Ç)
   - –ò—Å–ø—Ä–∞–≤–∏—Ç—å `first_message_today?` –º–µ—Ç–æ–¥
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–æ–∫–∏ –¥–ª—è webhook

### Medium Priority
3. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å performance —Ç–µ—Å—Ç—ã** (15 –º–∏–Ω—É—Ç)
   - –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∫ —Ä–µ–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ–∂–∏–¥–∞–Ω–∏—è

4. **–î–æ–±–∞–≤–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã** (20 –º–∏–Ω—É—Ç)
   - –¢–µ—Å—Ç—ã –¥–ª—è EventConstants
   - –¢–µ—Å—Ç—ã –¥–ª—è ResponseTimeTracker
   - –¢–µ—Å—Ç—ã –¥–ª—è ServiceSuggestionTracker

## üîß –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### Step 1: –ò—Å–ø—Ä–∞–≤–∏—Ç—å autoload (15 –º–∏–Ω—É—Ç)
```ruby
# –í–æ–∑–º–æ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ test_helper.rb
Rails.application.eager_load! if Rails.env.test?
```

### Step 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã (10 –º–∏–Ω—É—Ç)
```bash
bin/rails test test/models/analytics_event_test.rb
bin/rails test test/services/analytics_service_test.rb
```

### Step 3: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã (30 –º–∏–Ω—É—Ç)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- Performance —Ç–µ—Å—Ç—ã
- Mock –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### Step 4: –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è (15 –º–∏–Ω—É—Ç)
```bash
bin/rails test test/analytics/
```

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (MVP)
- [ ] –í—Å–µ –º–æ–¥–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –í—Å–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –í—Å–µ job —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –ë–∞–∑–æ–≤—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

### –ü–æ–ª–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (48/48)
- [ ] –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ > 80%
- [ ] Performance —Ç–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] CI –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É

## üìä –ü—Ä–æ–≥—Ä–µ—Å—Å

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –í—Å–µ–≥–æ | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | –û—Å—Ç–∞–ª–æ—Å—å | % |
|-----------|-------|------------|---------|----|
| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ | 1 | ‚úÖ 1 | 0 | 100% |
| –ú–æ–¥–µ–ª–∏ | 1 | üîÑ 0 | 1 | 0% |
| –°–µ—Ä–≤–∏—Å—ã | 1 | ‚úÖ 1 | 0 | 100% |
| Jobs | 1 | ‚úÖ 1 | 0 | 100% |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | 1 | üîÑ 0 | 1 | 0% |
| Performance | 1 | üîÑ 0 | 1 | 0% |

**–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å:** 50% (3/6 –∫–∞—Ç–µ–≥–æ—Ä–∏–π)

## ‚è±Ô∏è –û—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è

- **MVP –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 1 —á–∞—Å
- **–ü–æ–ª–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 2 —á–∞—Å–∞

## üîÑ –ü–ª–∞–Ω –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤
2. –î–æ–±–∞–≤–∏—Ç—å coverage –æ—Ç—á–µ—Ç—ã
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã Metabase
4. –°–æ–∑–¥–∞—Ç—å –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã

---

**–°—Ç–∞—Ç—É—Å:** üîÑ **–í –ü–†–û–¶–ï–°–°–ï**
**–°–ª–µ–¥—É—é—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å autoload –º–æ–¥–µ–ª–µ–π –≤ —Ç–µ—Å—Ç–∞—Ö